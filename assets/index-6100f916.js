import{d as Y,r as y,a as Z,A as $,s as x,u as ee,o as ae,I as le,b as se,c as te,k as g,e as a,w as s,l as oe,H as re,L as r,M as w,N as b,O as ce,f as o,J as ue,i as E,p as de,j as ne,E as P,P as V,__tla as ie}from"./index-d2e32ea4.js";import{g as q}from"./base64-ae67ffac.js";import{_ as pe}from"./_plugin-vue_export-helper-c27b6911.js";let A,me=Promise.all([(()=>{try{return ie}catch{}})()]).then(async()=>{const L=i=>(de("data-v-1c866a30"),i=i(),ne(),i),M={class:"login-div"},R=L(()=>g("div",{class:"login-div-title"},[g("h1",null,"Login")],-1)),S={class:"login-div-form"},G=["src"],C=60*24*60*60,T=Y({__name:"index",setup(i){const N=y(),p=y(!1),e=Z({userName:"",password:"",captchaCode:"",isCaptcha:!0,captchaUuid:"",loginDevice:1,remember:null}),v=$();x(()=>v==null?void 0:v.getWebsiteTitle);const j=ee(),h=oe(),I=re(),z=async()=>{await N.value.validate(async l=>{var t;if(l){p.value=!0;try{const{code:u,message:f}=await j.login(e);if(p.value=!0,u==200){const d=decodeURIComponent(((t=I.query)==null?void 0:t.redirect)||"/");O(),P.success("Sign in successful"),H(),I.name===V.SIGN_IN_NAME?h.replace("/account"):h.replace(d)}else u&&u===30001&&(e.captchaCode="")}finally{m(),p.value=!1}}else P.error("error submit!")})},B=x(()=>!(e.userName&&e.password&&e.captchaCode)),D=()=>{let l=r.get(w,"");l&&(e.userName=l,e.password=q.decode(r.get(b,"")),e.remember=!0)},H=()=>{if(e.remember){let l=q.encode(e.password);r.set(b,l,C),r.set(w,e.userName,C)}else r.remove(w),r.remove(b)},k=y("");async function m(){try{let l=await ce();k.value=l.captchaBase64Image,e.captchaUuid=l.captchaUuid,J(l.expireSeconds)}catch(l){console.log(l)}}let c=null;function J(l){c===null&&(c=setInterval(m,(l-5)*1e3))}function O(){c!=null&&(clearInterval(c),c=null)}ae(()=>{m(),D()});const W=()=>{open.value=!1,h.push({name:V.REGISTER_PAGE_NAME})};return(l,t)=>{const u=o("User"),f=o("el-icon"),d=o("el-input"),_=o("el-form-item"),F=o("Lock"),K=o("Tickets"),U=o("el-button"),Q=o("el-form"),X=ue("loading");return le((se(),te("div",M,[R,g("div",S,[a(Q,{ref_key:"formRef",ref:N,size:"large",model:e,"label-width":"100"},{default:s(()=>[a(_,{label:"E-Mail",prop:"userName",rules:[{required:!0,message:"Please input your email!"}]},{default:s(()=>[a(d,{modelValue:e.userName,"onUpdate:modelValue":t[0]||(t[0]=n=>e.userName=n)},{prefix:s(()=>[a(f,null,{default:s(()=>[a(u)]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(_,{label:"Password",prop:"password",rules:[{required:!0,message:"Please input your password!"}]},{default:s(()=>[a(d,{type:"password",modelValue:e.password,"onUpdate:modelValue":t[1]||(t[1]=n=>e.password=n)},{prefix:s(()=>[a(f,null,{default:s(()=>[a(F)]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(_,{label:"Captcha",prop:"captchaCode",rules:[{required:!0,message:"Please input your captcha code!"}]},{default:s(()=>[a(d,{modelValue:e.captchaCode,"onUpdate:modelValue":t[2]||(t[2]=n=>e.captchaCode=n),class:"login-div-form-code"},{prefix:s(()=>[a(f,null,{default:s(()=>[a(K)]),_:1})]),_:1},8,["modelValue"]),g("img",{class:"captcha-img",src:k.value,onClick:m},null,8,G)]),_:1}),a(_,null,{default:s(()=>[a(U,{disabled:B.value,onClick:z,type:"primary",style:{"margin-left":"100px"}},{default:s(()=>[E(" Login ")]),_:1},8,["disabled"]),a(U,{onClick:W,style:{float:"right"}},{default:s(()=>[E(" Create an account ")]),_:1})]),_:1})]),_:1},8,["model"])])])),[[X,p.value,void 0,{fullscreen:!0,lock:!0}]])}}});A=pe(T,[["__scopeId","data-v-1c866a30"]])});export{me as __tla,A as default};
